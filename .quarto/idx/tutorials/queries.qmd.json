{"title":"Attribute and spatial queries","markdown":{"yaml":{"title":"Attribute and spatial queries","page-layout":"article"},"headingText":"Overview","containsRefs":false,"markdown":"\n\nIn this tutorial, you will learn how to select geographic features based on their association with non-spatial and also based on their location.\n\n## Data Exploration\n\nSet working directory\n\n```{r}\nsetwd(\"C:/Users/devmbeya/Documents/giswithrtutorials\") \ngetwd() #check the file path of the current directory\n```\n\nLoad required packages\n\n```{r}\nlibrary(sf)\nlibrary(dplyr)\n```\n\nRead data\n\n```{r}\nafrica <- st_read(\"../assets/data/vector/africa.shp\")\nafrica_project <- st_read(\"../assets/data/vector/africa_project.shp\")\nafrica_continent <- st_read(\"../assets/data/vector/africa_continent.shp\")\ncities <- st_read(\"../assets/data/vector/africa_capital_cities.shp\")\nroads <- st_read(\"../assets/data/vector/africa_roads.shp\")\n```\n\n## Attribute queries\n\nGIS data comes in two forms: spatial and attribute data. Spatial data represents the aspects of geography inform of map layers. Attribute data in GIS describe the properties or characteristics of the spatial features. A school would have its spatial data represented as geographic coordinates(latitudes and longitudes) and its attribute data would include name of the school, student enrollment, number of teachers, name of district it is located in etc.\n\nAttribute queries select geographic features based on their association with attributes (non-spatial data). This is achieved by using conditions such as field names(e.g., `ADIMN`, `NAME`), operators (e.g., `<`, `>`, `=`, `==`) and values (e.g., `Malawi`, `TRUE`, `20000`).\n\n```{r}\n#| label: Explore data\n#| echo: true\n#| code-line-numbers: true\nafrica #print Africa sf\n\n# Check column names, use the names() function\nnames(africa)\n\n# check coordinates of the polygons\nafrica$geom\n\n# Check the ADMIN column values\nafrica$ADMIN\n```\n\n#### Subsetting vector data\n\nIn R, you van use `dplyr` subsetting functions to select a subset of the data: rows or columns. You can use the `filter()` and `slice` functions to select rows and `select()` to subset columns.\n\nSelect countries with population greater than 80 million. Use the dplyr's `filter()` function.\n\n```{r}\n# Once again explore the data\nhead(africa)\n\n# Select countries with population greater than 80 million\npop <- filter(africa, POP_EST > 80000000)\npop\n\n# Plot the selected polygons\nplot(pop$geometry)\n```\n\nSelect South Africa and Malawi polygons\n\n```{r}\nsouth_africa <- filter(africa, NAME_EN == 'South Africa' | NAME_EN==\"Malawi\")\n\nplot(south_africa$geometry)\n```\n\nSelect Malawi's neighbors\n\n```{r}\n#| label: Select multiple attributes\n#| echo: true\n#| code-line-numbers: true\nmalawi_and_neighb <- filter(africa, NAME_EN == 'Malawi' | NAME_EN==\"Zambia\" | NAME_EN == \"Mozambique\" | NAME_EN == \"Tanzania\")\n\nplot(malawi_and_neighb$geometry)\n```\n\n## Spatial queries\n\nTo select features by their location, we can use topological relations between vector geometries.\n\nTo select features by their **location**, we can use topological relations between vector geometries in `sf`. Common functions include:\n\n-   `st_intersects(x, y)` – returns features in `x` that **intersect** features in `y`.\n-   `st_touches(x, y)` – returns features in `x` that **touch** features in `y` (share a boundary but do not overlap).\n-   `st_overlaps(x, y)` – returns features in `x` that **overlap** features in `y` partially.\n-   `st_contains(x, y)` – returns features in `x` that **contain** features in `y`.\n-   `st_contains_properly(x, y)` – stricter version of `st_contains`.\n-   `st_covers(x, y)` – returns features in `x` that **cover** features in `y`.\n-   `st_within(x, y)` – returns features in `x` that are **within** features in `y`.\n-   `st_covered_by(x, y)` – returns features in `x` that are **covered by** features in `y`.\n-   `st_disjoint(x, y)` – returns features in `x` that **do not intersect** features in `y`.\n\nSelect cities that are located within East African countries.\n\n```{r}\n#| label: Select data based on location\n#| echo: true\n#| code-line-numbers: true\nplot(cities$geometry)\n\n# Select countries within Eastern Africa\neast_africa <- filter(africa, SUBREGION == 'Eastern Africa')\n\n# Plot East African countries\nplot(east_africa$geometry)\n\n# Select and plot all eastern African cities\neast_cities <- st_intersection(x = cities, y=east_africa)\n\nplot(east_cities$geometry, add=TRUE, col='blue', pch=16)\n\nplot(cities$geometry, add=TRUE)\n```\n","srcMarkdownNoYaml":"\n\n## Overview\nIn this tutorial, you will learn how to select geographic features based on their association with non-spatial and also based on their location.\n\n## Data Exploration\n\nSet working directory\n\n```{r}\nsetwd(\"C:/Users/devmbeya/Documents/giswithrtutorials\") \ngetwd() #check the file path of the current directory\n```\n\nLoad required packages\n\n```{r}\nlibrary(sf)\nlibrary(dplyr)\n```\n\nRead data\n\n```{r}\nafrica <- st_read(\"../assets/data/vector/africa.shp\")\nafrica_project <- st_read(\"../assets/data/vector/africa_project.shp\")\nafrica_continent <- st_read(\"../assets/data/vector/africa_continent.shp\")\ncities <- st_read(\"../assets/data/vector/africa_capital_cities.shp\")\nroads <- st_read(\"../assets/data/vector/africa_roads.shp\")\n```\n\n## Attribute queries\n\nGIS data comes in two forms: spatial and attribute data. Spatial data represents the aspects of geography inform of map layers. Attribute data in GIS describe the properties or characteristics of the spatial features. A school would have its spatial data represented as geographic coordinates(latitudes and longitudes) and its attribute data would include name of the school, student enrollment, number of teachers, name of district it is located in etc.\n\nAttribute queries select geographic features based on their association with attributes (non-spatial data). This is achieved by using conditions such as field names(e.g., `ADIMN`, `NAME`), operators (e.g., `<`, `>`, `=`, `==`) and values (e.g., `Malawi`, `TRUE`, `20000`).\n\n```{r}\n#| label: Explore data\n#| echo: true\n#| code-line-numbers: true\nafrica #print Africa sf\n\n# Check column names, use the names() function\nnames(africa)\n\n# check coordinates of the polygons\nafrica$geom\n\n# Check the ADMIN column values\nafrica$ADMIN\n```\n\n#### Subsetting vector data\n\nIn R, you van use `dplyr` subsetting functions to select a subset of the data: rows or columns. You can use the `filter()` and `slice` functions to select rows and `select()` to subset columns.\n\nSelect countries with population greater than 80 million. Use the dplyr's `filter()` function.\n\n```{r}\n# Once again explore the data\nhead(africa)\n\n# Select countries with population greater than 80 million\npop <- filter(africa, POP_EST > 80000000)\npop\n\n# Plot the selected polygons\nplot(pop$geometry)\n```\n\nSelect South Africa and Malawi polygons\n\n```{r}\nsouth_africa <- filter(africa, NAME_EN == 'South Africa' | NAME_EN==\"Malawi\")\n\nplot(south_africa$geometry)\n```\n\nSelect Malawi's neighbors\n\n```{r}\n#| label: Select multiple attributes\n#| echo: true\n#| code-line-numbers: true\nmalawi_and_neighb <- filter(africa, NAME_EN == 'Malawi' | NAME_EN==\"Zambia\" | NAME_EN == \"Mozambique\" | NAME_EN == \"Tanzania\")\n\nplot(malawi_and_neighb$geometry)\n```\n\n## Spatial queries\n\nTo select features by their location, we can use topological relations between vector geometries.\n\nTo select features by their **location**, we can use topological relations between vector geometries in `sf`. Common functions include:\n\n-   `st_intersects(x, y)` – returns features in `x` that **intersect** features in `y`.\n-   `st_touches(x, y)` – returns features in `x` that **touch** features in `y` (share a boundary but do not overlap).\n-   `st_overlaps(x, y)` – returns features in `x` that **overlap** features in `y` partially.\n-   `st_contains(x, y)` – returns features in `x` that **contain** features in `y`.\n-   `st_contains_properly(x, y)` – stricter version of `st_contains`.\n-   `st_covers(x, y)` – returns features in `x` that **cover** features in `y`.\n-   `st_within(x, y)` – returns features in `x` that are **within** features in `y`.\n-   `st_covered_by(x, y)` – returns features in `x` that are **covered by** features in `y`.\n-   `st_disjoint(x, y)` – returns features in `x` that **do not intersect** features in `y`.\n\nSelect cities that are located within East African countries.\n\n```{r}\n#| label: Select data based on location\n#| echo: true\n#| code-line-numbers: true\nplot(cities$geometry)\n\n# Select countries within Eastern Africa\neast_africa <- filter(africa, SUBREGION == 'Eastern Africa')\n\n# Plot East African countries\nplot(east_africa$geometry)\n\n# Select and plot all eastern African cities\neast_cities <- st_intersection(x = cities, y=east_africa)\n\nplot(east_cities$geometry, add=TRUE, col='blue', pch=16)\n\nplot(cities$geometry, add=TRUE)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["assets/css/custom.scss"],"toc":true,"toc-depth":3,"output-file":"queries.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","theme":{"light":"cosmo","dark":"cyborg"},"code-copy":true,"smooth-scroll":true,"title":"Attribute and spatial queries","page-layout":"article"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}